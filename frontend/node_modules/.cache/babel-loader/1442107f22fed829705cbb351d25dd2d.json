{"ast":null,"code":"import _defineProperty from\"/home/oliver/Desktop/awl-raumreservierung/frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"/home/oliver/Desktop/awl-raumreservierung/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/home/oliver/Desktop/awl-raumreservierung/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/oliver/Desktop/awl-raumreservierung/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/oliver/Desktop/awl-raumreservierung/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";// Component imports\nimport React,{useState,useContext,useEffect}from'react';import{Stack,Button,Form,Modal,Row,Col,Table}from'react-bootstrap';import{useNavigate}from'react-router-dom';import AppNavBar from'./components/AppNavBar';import UserPageContextProvider,{UserPageContext}from'../contexts/UserPageContext';import moment from'moment';// Style imports\nimport'../css/components/UserPage.css';// API imports\nimport UserAPI from'../api/user';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function UserPage(){return/*#__PURE__*/_jsx(UserPageContextProvider,{children:/*#__PURE__*/_jsxs(Stack,{direction:\"vertical\",children:[/*#__PURE__*/_jsx(AppNavBar,{}),/*#__PURE__*/_jsx(UserPageContent,{}),/*#__PURE__*/_jsx(ChangePasswordModal,{})]})});};function UserPageContent(){var _useContext=useContext(UserPageContext),upContext=_useContext.upContext,setUpContext=_useContext.setUpContext;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),userData=_useState2[0],setUserData=_useState2[1];useEffect(function(){function doAsync(){return _doAsync.apply(this,arguments);}function _doAsync(){_doAsync=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.t0=setUserData;_context.next=3;return UserAPI.getUserData();case 3:_context.t1=_context.sent;(0,_context.t0)(_context.t1);case 5:case\"end\":return _context.stop();}}},_callee);}));return _doAsync.apply(this,arguments);}doAsync();},[]);var onChangePassword=function onChangePassword(){setUpContext(_objectSpread(_objectSpread({},upContext),{},{uiControl:_objectSpread(_objectSpread({},upContext.uiControl),{},{changePWModal:true})}));};return/*#__PURE__*/_jsx(Row,{className:\"justify-content-center align-items-center\",style:{height:'80vh'},children:/*#__PURE__*/_jsxs(Col,{md:5,children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-center\",children:\"Profil\"}),/*#__PURE__*/_jsx(Table,{bordered:true,className:\"userprofile\",children:/*#__PURE__*/_jsxs(\"tbody\",{children:[/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:\"Benutzername:\"}),/*#__PURE__*/_jsx(\"td\",{children:userData===null||userData===void 0?void 0:userData.username})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:\"Vorname:\"}),/*#__PURE__*/_jsx(\"td\",{children:userData===null||userData===void 0?void 0:userData.firstName})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:\"Nachname:\"}),/*#__PURE__*/_jsx(\"td\",{children:userData===null||userData===void 0?void 0:userData.lastname})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:\"Rolle:\"}),/*#__PURE__*/_jsx(\"td\",{children:userData===null||userData===void 0?void 0:userData.role})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:\"Letzter Login:\"}),/*#__PURE__*/_jsx(\"td\",{children:moment(userData===null||userData===void 0?void 0:userData.lastLogon).format(\"DD.MM.YYYY HH:mm\")})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:\"Passwort \\xE4ndern: \"}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Button,{onClick:onChangePassword,children:\"Passwort \\xE4ndern\"})})]})]})})]})});}function ChangePasswordModal(){var navigate=useNavigate();var _useContext2=useContext(UserPageContext),upContext=_useContext2.upContext,setUpContext=_useContext2.setUpContext;var _useState3=useState({password:\"\",repeat:\"\"}),_useState4=_slicedToArray(_useState3,2),values=_useState4[0],setValues=_useState4[1];var onChange=function onChange(e){setValues(_objectSpread(_objectSpread({},values),{},_defineProperty({},e.target.name,e.target.value)));};var onSubmit=function onSubmit(){function doAsync(){return _doAsync2.apply(this,arguments);}function _doAsync2(){_doAsync2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(values.password===values.repeat)){_context2.next=3;break;}_context2.next=3;return UserAPI.changePassword(values.password);case 3:onCancel();localStorage.clear();navigate(\"/login\");case 6:case\"end\":return _context2.stop();}}},_callee2);}));return _doAsync2.apply(this,arguments);}doAsync();};var onCancel=function onCancel(){setUpContext(_objectSpread(_objectSpread({},upContext),{},{uiControl:_objectSpread(_objectSpread({},upContext.uiControl),{},{changePWModal:false})}));};return/*#__PURE__*/_jsxs(Modal,{show:upContext.uiControl.changePWModal,onHide:onCancel,centered:true,children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,children:/*#__PURE__*/_jsx(Modal.Title,{children:\"Passwort \\xE4ndern\"})}),/*#__PURE__*/_jsx(Modal.Body,{children:/*#__PURE__*/_jsxs(Form,{children:[/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",controlId:\"changePassword\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Neues Passwort\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"password\",name:\"password\",onChange:onChange,value:values.password})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",controlId:\"changePasswordConfirm\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Neues Passwort wiederholen\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"password\",name:\"repeat\",onChange:onChange,value:values.repeat})]})]})}),/*#__PURE__*/_jsxs(Modal.Footer,{children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:onCancel,children:\"Abbrechen\"}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:onSubmit,children:\"Speichern\"})]})]});}","map":{"version":3,"names":["React","useState","useContext","useEffect","Stack","Button","Form","Modal","Row","Col","Table","useNavigate","AppNavBar","UserPageContextProvider","UserPageContext","moment","UserAPI","UserPage","UserPageContent","upContext","setUpContext","userData","setUserData","doAsync","getUserData","onChangePassword","uiControl","changePWModal","height","username","firstName","lastname","role","lastLogon","format","ChangePasswordModal","navigate","password","repeat","values","setValues","onChange","e","target","name","value","onSubmit","changePassword","onCancel","localStorage","clear"],"sources":["/home/oliver/Desktop/awl-raumreservierung/frontend/src/pages/UserPage.js"],"sourcesContent":["// Component imports\nimport React, { useState, useContext, useEffect } from 'react';\nimport {Stack, Button, Form, Modal, Row, Col, Table} from 'react-bootstrap';\nimport { useNavigate } from 'react-router-dom';\nimport AppNavBar from './components/AppNavBar';\nimport UserPageContextProvider, {UserPageContext} from '../contexts/UserPageContext';\nimport moment from 'moment';\n// Style imports\nimport '../css/components/UserPage.css';\n// API imports\nimport UserAPI from '../api/user';\n\nexport default function UserPage(){\n    return(\n        <UserPageContextProvider>\n            <Stack direction='vertical'>\n                <AppNavBar />\n                <UserPageContent />\n                <ChangePasswordModal />\n            </Stack>\n        </UserPageContextProvider>\n    );\n};\n\nfunction UserPageContent(){\n    const {upContext, setUpContext} = useContext(UserPageContext);\n    const [userData, setUserData] = useState(null);\n\n    useEffect(() => {\n        async function doAsync(){\n            setUserData(await UserAPI.getUserData());\n        }\n        doAsync();\n    }, []);\n\n    const onChangePassword = () => {\n        setUpContext({...upContext, uiControl: {...upContext.uiControl, changePWModal: true}});\n    };\n\n    return(\n        <Row className=\"justify-content-center align-items-center\" style={{ height: '80vh' }}>\n            <Col md={5}>\n                <h2 className=\"text-center\">Profil</h2>\n                <Table bordered className='userprofile'>\n                    <tbody>\n                        <tr>\n                            <td>Benutzername:</td>\n                            <td>{userData?.username}</td>\n                        </tr>\n                        <tr>\n                            <td>Vorname:</td>\n                            <td>{userData?.firstName}</td>\n                        </tr>\n                        <tr>\n                            <td>Nachname:</td>\n                            <td>{userData?.lastname}</td>\n                        </tr>\n                        <tr>\n                            <td>Rolle:</td>\n                            <td>{userData?.role}</td>\n                        </tr>\n                        <tr>\n                            <td>Letzter Login:</td>\n                            <td>{moment(userData?.lastLogon).format(\"DD.MM.YYYY HH:mm\")}</td>\n                        </tr>\n                        <tr>\n                            <td>Passwort ändern: </td>\n                            <td>\n                                <Button onClick={onChangePassword}>\n                                    Passwort ändern\n                                </Button>\n                            </td>\n                        </tr>\n                    </tbody>\n                </Table>                    \n            </Col>\n        </Row>\n    );\n}\n\nfunction ChangePasswordModal(){\n    const navigate = useNavigate();\n    const {upContext, setUpContext} = useContext(UserPageContext);\n    const [values, setValues] = useState({password: \"\", repeat: \"\"});\n\n    const onChange = (e) => {\n        setValues({...values, [e.target.name]: e.target.value});\n    };\n\n    const onSubmit = () => {\n        async function doAsync(){\n            if(values.password === values.repeat) await UserAPI.changePassword(values.password);\n\n            onCancel();\n            localStorage.clear();\n            navigate(\"/login\");\n        }\n        doAsync();\n    };\n\n    const onCancel = () => {\n        setUpContext({...upContext, uiControl: {...upContext.uiControl, changePWModal: false}});\n    }\n\n    return(\n        <Modal show={upContext.uiControl.changePWModal} onHide={onCancel} centered>\n            <Modal.Header closeButton>\n                <Modal.Title>Passwort ändern</Modal.Title>\n            </Modal.Header>\n            <Modal.Body>\n                <Form>\n                    <Form.Group className=\"mb-3\" controlId=\"changePassword\">\n                        <Form.Label>Neues Passwort</Form.Label>\n                        <Form.Control type=\"password\" name=\"password\" onChange={onChange} value={values.password} />\n                    </Form.Group>\n                    <Form.Group className=\"mb-3\" controlId=\"changePasswordConfirm\">\n                        <Form.Label>Neues Passwort wiederholen</Form.Label>\n                        <Form.Control type=\"password\" name=\"repeat\" onChange={onChange} value={values.repeat} />\n                    </Form.Group>                                      \n                </Form> \n            </Modal.Body>\n            <Modal.Footer>\n                <Button variant=\"secondary\" onClick={onCancel}>\n                    Abbrechen\n                </Button>\n                <Button variant=\"primary\" onClick={onSubmit}>\n                    Speichern\n                </Button>\n            </Modal.Footer>\n        </Modal>\n    );\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}