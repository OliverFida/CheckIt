{"ast":null,"code":"import _regeneratorRuntime from\"/home/oliver/Desktop/awl-raumreservierung/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"/home/oliver/Desktop/awl-raumreservierung/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/home/oliver/Desktop/awl-raumreservierung/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/oliver/Desktop/awl-raumreservierung/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";// Component imports\nimport React,{useState,useEffect,useContext}from'react';import{HomePageContext}from'../../contexts/HomePageContext';import StundenplanBooking from'./StundenplanBooking';import moment from'moment';// API imports\nimport BookingsAPI from'../../api/bookings';import timesMap from'../../api/timesMap.json';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var amountWeeks=6;export default function StundenplanBody(){var _useContext=useContext(HomePageContext),hpContext=_useContext.hpContext,setHpContext=_useContext.setHpContext;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),elements=_useState2[0],setElements=_useState2[1];useEffect(function(){var newElements=[];timesMap.forEach(function(lesson){newElements.push(/*#__PURE__*/_jsx(StundenplanRow,{lesson:lesson},\"row_\".concat(lesson.key)));});setElements(newElements);},[]);useEffect(function(){function doAsync(){return _doAsync.apply(this,arguments);}function _doAsync(){_doAsync=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var temp;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log(\"RoomID changed [Body]: \"+hpContext.roomSelection.id);if(!(hpContext.roomSelection.id===null)){_context.next=3;break;}return _context.abrupt(\"return\");case 3:_context.next=5;return setHpContext(_objectSpread(_objectSpread({},hpContext),{},{uiControl:_objectSpread(_objectSpread({},hpContext.uiControl),{},{bookingsLoading:true})}));case 5:console.log(\"Getting Bookings\");_context.next=8;return BookingsAPI.getBookings(hpContext.roomSelection.id,moment().weekday(1).toJSON(),moment().weekday(5).add(amountWeeks-1,'weeks').toJSON());case 8:temp=_context.sent;_context.next=11;return setHpContext(_objectSpread(_objectSpread({},hpContext),{},{uiControl:_objectSpread(_objectSpread({},hpContext.uiControl),{},{bookingsLoading:false}),bookings:_objectSpread(_objectSpread({},hpContext.bookings),{},{reload:false,bookings:temp})}));case 11:console.log(\"Set' Bookings\");case 12:case\"end\":return _context.stop();}}},_callee);}));return _doAsync.apply(this,arguments);}doAsync();},[hpContext.roomSelection.id,hpContext.bookings.reload]);return/*#__PURE__*/_jsx(\"tbody\",{children:elements});}function StundenplanRow(_ref){var lesson=_ref.lesson;var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),elements=_useState4[0],setElements=_useState4[1];useEffect(function(){var newElements=[];for(var day=1;day<amountWeeks;day++){if(lesson.key!==\"break\"){newElements.push(/*#__PURE__*/_jsx(StundenplanBooking,{day:day,lesson:lesson},\"booking_\".concat(day,\"_\").concat(lesson.key)));}else{newElements.push(/*#__PURE__*/_jsx(\"td\",{},\"break_\".concat(day)));}}setElements(newElements);},[]);return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(StundenplanRowTitle,{lesson:lesson}),elements]});}function StundenplanRowTitle(_ref2){var lesson=_ref2.lesson;var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),title=_useState6[0],setTitle=_useState6[1];useEffect(function(){if(lesson.key!==\"break\"){setTitle(\"Stunde \".concat(lesson.key));}else{setTitle(\"Pause\");}},[]);return/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"rowTitle\",children:[/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsx(\"b\",{children:title})}),/*#__PURE__*/_jsxs(\"span\",{children:[lesson.start,\" - \",lesson.end]})]})},\"title\");}","map":{"version":3,"names":["React","useState","useEffect","useContext","HomePageContext","StundenplanBooking","moment","BookingsAPI","timesMap","amountWeeks","StundenplanBody","hpContext","setHpContext","elements","setElements","newElements","forEach","lesson","push","key","doAsync","console","log","roomSelection","id","uiControl","bookingsLoading","getBookings","weekday","toJSON","add","temp","bookings","reload","StundenplanRow","day","StundenplanRowTitle","title","setTitle","start","end"],"sources":["/home/oliver/Desktop/awl-raumreservierung/frontend/src/pages/components/StundenplanBody.js"],"sourcesContent":["// Component imports\nimport React, {useState, useEffect, useContext} from 'react';\nimport { HomePageContext } from '../../contexts/HomePageContext';\nimport StundenplanBooking from './StundenplanBooking';\nimport moment from 'moment';\n// API imports\nimport BookingsAPI from '../../api/bookings';\nimport timesMap from '../../api/timesMap.json';\n\nconst amountWeeks = 6;\n\nexport default function StundenplanBody(){\n    const {hpContext, setHpContext} = useContext(HomePageContext);\n    const [elements, setElements] = useState([]);\n    \n    useEffect(() => {\n        var newElements = [];\n        timesMap.forEach(lesson => {\n            newElements.push(<StundenplanRow key={`row_${lesson.key}`} lesson={lesson} />);\n        });\n        setElements(newElements);\n    }, []);\n\n    useEffect(() => {\n        async function doAsync(){\n            console.log(\"RoomID changed [Body]: \" + hpContext.roomSelection.id);\n            if(hpContext.roomSelection.id === null) return; //TODO: Double reloading\n            await setHpContext({...hpContext, uiControl: {...hpContext.uiControl, bookingsLoading: true}});\n            console.log(\"Getting Bookings\");\n            var temp = await BookingsAPI.getBookings(hpContext.roomSelection.id, moment().weekday(1).toJSON(), moment().weekday(5).add(amountWeeks - 1, 'weeks').toJSON());\n            await setHpContext({...hpContext, uiControl: {...hpContext.uiControl, bookingsLoading: false}, bookings: {...hpContext.bookings, reload: false, bookings: temp}});\n            console.log(\"Set' Bookings\");\n        }\n        doAsync();\n    }, [hpContext.roomSelection.id, hpContext.bookings.reload]);\n\n    return(\n        <tbody>\n            {elements}\n        </tbody>\n    );\n}\n\nfunction StundenplanRow({lesson}){\n    const [elements, setElements] = useState([]);\n\n    useEffect(() => {\n        var newElements = [];\n        for(var day = 1; day < amountWeeks; day++){\n            if(lesson.key !== \"break\"){\n                newElements.push(<StundenplanBooking key={`booking_${day}_${lesson.key}`} day={day} lesson={lesson} />);\n            }else{\n                newElements.push(<td key={`break_${day}`} />);\n            }\n        }\n        setElements(newElements);\n    }, []);\n\n    return(\n        <tr>\n            <StundenplanRowTitle lesson={lesson} />\n            {elements}\n        </tr>\n    );\n}\n\nfunction StundenplanRowTitle({lesson}){\n    const [title, setTitle] = useState(\"\");\n\n    useEffect(() => {\n        if(lesson.key !== \"break\"){\n            setTitle(`Stunde ${lesson.key}`);\n        }else{\n            setTitle(\"Pause\");\n        }\n    }, []);\n\n    return(\n        <td key=\"title\">\n            <div className=\"rowTitle\">\n                <span><b>{title}</b></span>\n                <span>{lesson.start} - {lesson.end}</span>\n            </div>\n        </td>\n    );\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}