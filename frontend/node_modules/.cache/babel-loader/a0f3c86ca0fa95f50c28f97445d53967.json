{"ast":null,"code":"import _objectSpread from\"/home/oliver/Desktop/awl-raumreservierung/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/home/oliver/Desktop/awl-raumreservierung/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";// Component imports\nimport React,{useState,useEffect,useContext}from'react';import moment from'moment';import{Button}from'react-bootstrap';import{HomePageContext}from'../../contexts/HomePageContext';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function StundenplanBooking(_ref){var day=_ref.day,lesson=_ref.lesson;var _useContext=useContext(HomePageContext),hpContext=_useContext.hpContext,setHpContext=_useContext.setHpContext;var _useState=useState({variant:'light',disabled:false,onClick:null,text:\"\",user:null,tooltip:\"\"}),_useState2=_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];useEffect(function(){console.log(\"Rendering Booking \"+day+\"-\"+lesson.key);var targetHourStart=lesson.start.substring(0,2);var targetMinuteStart=lesson.start.substring(3,5);var targetDateStart=moment().weekday(1).add(hpContext.weekSelection.offset,'weeks').add(day-1,'days');targetDateStart.set('hours',targetHourStart).set('minutes',targetMinuteStart).set('seconds',1).set('milliseconds',0);var targetHourEnd=lesson.end.substring(0,2);var targetMinuteEnd=lesson.end.substring(3,5);var targetDateEnd=moment(targetDateStart);targetDateEnd.set('hours',targetHourEnd).set('minutes',targetMinuteEnd).set('seconds',0).set('milliseconds',0);var timeOver=false;if(targetDateStart.isBefore(moment()))timeOver=true;var foundBooking=hpContext.bookings.bookings.find(function(booking){if(targetDateStart.add(1,'second').isBetween(moment.utc(booking.startTime),moment.utc(booking.endTime).add(1,'second'))&&targetDateEnd.subtract(1,'second').isBetween(moment.utc(booking.startTime),moment.utc(booking.endTime).add(1,'second'))){return true;}return false;});var loginUsername=localStorage.getItem('loginUsername');if(!foundBooking){setState(_objectSpread(_objectSpread({},state),{},{variant:'light',disabled:timeOver,onClick:function onClick(){_onClick(false,false,foundBooking);},text:\"Buchen\",user:null,tooltip:\"\"}));}else if(loginUsername!==foundBooking.user.username){setState(_objectSpread(_objectSpread({},state),{},{variant:'danger',disabled:timeOver,onClick:function onClick(){_onClick(false,true,foundBooking);},text:\"Gebucht von\",user:\"\".concat(foundBooking.user.firstName,\" \").concat(foundBooking.user.lastname),tooltip:foundBooking.note}));}else{setState(_objectSpread(_objectSpread({},state),{},{variant:'success',disabled:timeOver,onClick:function onClick(){_onClick(true,false,foundBooking);},text:\"Gebucht von\",user:\"\".concat(foundBooking.user.firstName,\" \").concat(foundBooking.user.lastname),tooltip:foundBooking.note}));}},[hpContext.bookings.bookings,hpContext.weekSelection.offset]);useEffect(function(){var _state$booking;if(state.booking!==null)console.log(\"Assigned: \"+((_state$booking=state.booking)===null||_state$booking===void 0?void 0:_state$booking.id));},[state.booking]);var _onClick=function _onClick(editMode,viewMode,booking){var _state$booking2;console.log(\"Button Booking: \"+((_state$booking2=state.booking)===null||_state$booking2===void 0?void 0:_state$booking2.id));setHpContext(_objectSpread(_objectSpread({},hpContext),{},{bookings:_objectSpread(_objectSpread({},hpContext.bookings),{},{selected:{day:day,lesson:lesson.key,booking:booking,editMode:editMode,viewMode:viewMode}})}));};return/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(Button,{className:\"buchenBtn\",variant:state.variant,disabled:state.disabled,onClick:state.onClick,children:[state.text,/*#__PURE__*/_jsx(\"br\",{}),state.user]})});}","map":{"version":3,"names":["React","useState","useEffect","useContext","moment","Button","HomePageContext","StundenplanBooking","day","lesson","hpContext","setHpContext","variant","disabled","onClick","text","user","tooltip","state","setState","console","log","key","targetHourStart","start","substring","targetMinuteStart","targetDateStart","weekday","add","weekSelection","offset","set","targetHourEnd","end","targetMinuteEnd","targetDateEnd","timeOver","isBefore","foundBooking","bookings","find","booking","isBetween","utc","startTime","endTime","subtract","loginUsername","localStorage","getItem","username","firstName","lastname","note","id","editMode","viewMode","selected"],"sources":["/home/oliver/Desktop/awl-raumreservierung/frontend/src/pages/components/StundenplanBooking.js"],"sourcesContent":["// Component imports\nimport React, {useState, useEffect, useContext} from 'react';\nimport moment from 'moment';\nimport { Button } from 'react-bootstrap';\nimport { HomePageContext } from '../../contexts/HomePageContext';\n\nexport default function StundenplanBooking({day, lesson}){\n    const {hpContext, setHpContext} = useContext(HomePageContext);\n    const [state, setState] = useState({variant: 'light', disabled: false, onClick: null, text: \"\", user: null, tooltip: \"\"});\n\n    useEffect(() => {\n        console.log(\"Rendering Booking \" + day + \"-\" + lesson.key);\n\n        var targetHourStart = lesson.start.substring(0, 2);\n        var targetMinuteStart = lesson.start.substring(3, 5);\n        var targetDateStart = moment().weekday(1).add(hpContext.weekSelection.offset, 'weeks').add(day - 1, 'days');\n        targetDateStart.set('hours', targetHourStart).set('minutes', targetMinuteStart).set('seconds', 1).set('milliseconds', 0);\n\n        var targetHourEnd = lesson.end.substring(0, 2);\n        var targetMinuteEnd = lesson.end.substring(3, 5);\n        var targetDateEnd = moment(targetDateStart);\n        targetDateEnd.set('hours', targetHourEnd).set('minutes', targetMinuteEnd).set('seconds', 0).set('milliseconds', 0);\n    \n        var timeOver = false;\n        if(targetDateStart.isBefore(moment())) timeOver = true;\n        \n        var foundBooking = hpContext.bookings.bookings.find(booking => {\n            if(targetDateStart.add(1, 'second').isBetween(moment.utc(booking.startTime), moment.utc(booking.endTime).add(1, 'second'))\n            && targetDateEnd.subtract(1, 'second').isBetween(moment.utc(booking.startTime), moment.utc(booking.endTime).add(1, 'second'))){\n                return true;\n            }\n            return false;\n        });\n        \n        var loginUsername = localStorage.getItem('loginUsername');\n        if(!foundBooking){\n            setState({...state, variant: 'light', disabled: timeOver, onClick: () => {onClick(false, false, foundBooking)}, text: \"Buchen\", user: null, tooltip: \"\"});\n        }else if(loginUsername !== foundBooking.user.username){\n            setState({...state, variant: 'danger', disabled: timeOver, onClick: ()=> {onClick(false, true, foundBooking)}, text: \"Gebucht von\", user: `${foundBooking.user.firstName} ${foundBooking.user.lastname}`, tooltip: foundBooking.note});\n        }else{\n            setState({...state, variant: 'success', disabled: timeOver, onClick: () => {onClick(true, false, foundBooking)}, text: \"Gebucht von\", user: `${foundBooking.user.firstName} ${foundBooking.user.lastname}`, tooltip: foundBooking.note});\n        }\n    }, [hpContext.bookings.bookings, hpContext.weekSelection.offset]);\n\n    useEffect(()=> {\n        if(state.booking !== null) console.log(\"Assigned: \" + state.booking?.id);\n    }, [state.booking]);\n\n    const onClick = (editMode, viewMode, booking) => {\n        console.log(\"Button Booking: \" + state.booking?.id);\n        setHpContext({...hpContext, bookings: {...hpContext.bookings, selected: {day: day, lesson: lesson.key, booking: booking, editMode: editMode, viewMode: viewMode}}});\n    }\n\n    return(\n        <td>\n            <Button className=\"buchenBtn\" variant={state.variant} disabled={state.disabled} onClick={state.onClick}>\n                {state.text}<br />{state.user}                   \n            </Button>                \n        </td>\n    );\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}